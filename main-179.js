(()=>{var t,n={419:(t,n,e)=>{"use strict";var o=e(212),i=e(886),s=e(564);class r{constructor(){this.onWindowResize=()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.fov=360/Math.PI*Math.atan(this.tanFOV*(window.innerHeight/1080)),this.camera.updateProjectionMatrix(),this.webGLRenderer.setSize(window.innerWidth,window.innerHeight),this.css3DRenderer.setSize(window.innerWidth,window.innerHeight)},this.webGLRenderer=r.initWebGLRenderer(),this.css3DRenderer=r.initCSS3DRenderer(),this.domElement=r.initDOMElement(this.webGLRenderer,this.css3DRenderer),this.initCamera(),window.addEventListener("resize",this.onWindowResize,!1),this.onWindowResize(),this.initRenderLoop()}animate(){this.scene&&(this.webGLRenderer.render(this.scene,this.camera),this.css3DRenderer.render(this.scene,this.camera)),this.controls.update()}initRenderLoop(){const t=()=>{this.animate(),requestAnimationFrame(t)};t()}initCamera(){this.camera=new o.cPb,this.camera.far=1e9,this.camera.near=1e-9,this.tanFOV=Math.tan(Math.PI/180*this.camera.fov/2),this.controls=new i.z(this.camera,this.css3DRenderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.1}static initDOMElement(t,n){const e=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div");return o.appendChild(t.domElement),i.appendChild(n.domElement),e.appendChild(o),e.appendChild(i),e}static initWebGLRenderer(){const t=new o.CP7({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0});return t.setClearColor(0,0),t.setPixelRatio(window.devicePixelRatio),t.shadowMap.enabled=!0,t.shadowMap.type=o.ntZ,t.domElement.style.position="absolute",t.domElement.style.top="0",t.domElement.style.bottom="0",t.domElement.style.left="0",t.domElement.style.zIndex="-1",t}static initCSS3DRenderer(){const t=new s.lX;return t.setSize(window.innerWidth,window.innerHeight),t.domElement.style.position="absolute",t.domElement.style.top="0",t.domElement.style.bottom="0",t.domElement.style.left="0",t.domElement.style.zIndex="-1",t}}var a=e(17),l=e.n(a),d=e(748),h=e.n(d),c=e(310),u=function(t,n,e,o){return new(e||(e=Promise))((function(i,s){function r(t){try{l(o.next(t))}catch(t){s(t)}}function a(t){try{l(o.throw(t))}catch(t){s(t)}}function l(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(r,a)}l((o=o.apply(t,n||[])).next())}))};const m={pointSize:10,pointsNumber:1e4,wobbliness:1,intensity:1,speed:1,randomColor:!0,pointColor:new o.Ilk(255,80,0)};var p=e(498),v=e.n(p),f=e(867),b=e(678);const x=t=>{t.computeBoundingBox();const n=1/Math.max(t.boundingBox.max.x-t.boundingBox.min.x,t.boundingBox.max.y-t.boundingBox.min.y);t.scale(n,n,n),t.computeBoundingBox();const e=new o.Pa4;t.boundingBox.min.x>=0&&(e.x=-t.boundingBox.min.x-.5*t.boundingBox.max.x),t.boundingBox.max.x<=0&&(e.x=-t.boundingBox.max.x-.5*t.boundingBox.min.x),t.boundingBox.min.y>=0&&(e.y=-t.boundingBox.min.y-.5*t.boundingBox.max.y),t.boundingBox.max.y<=0&&(e.y=-t.boundingBox.max.y-.5*t.boundingBox.min.y),t.boundingBox.min.z>=0&&(e.z=-t.boundingBox.min.z-.5*t.boundingBox.max.z),t.boundingBox.max.z<=0&&(e.z=-t.boundingBox.max.z-.5*t.boundingBox.min.z),t.translate(e.x,e.y,e.z)};const y=new r;document.body.appendChild(y.domElement);const w=m;var g,C,z,P,S;w.geometry=(g="./assets/donatty.svg",C=void 0,z=void 0,S=function*(){const t=new f.u;t.setCrossOrigin("anonymous");const n=(yield t.loadAsync(g)).paths,e=[];for(let t=0;t<n.length;t++){const i=n[t].toShapes(!0);for(let t=0,n=i.length;t<n;t++){const n=new o.oa8(i[t]);e.push(n)}}const i=b.O.mergeBufferGeometries(e);return i.applyMatrix4((new o.yGw).makeScale(1,-1,1)),x(i),i.toNonIndexed()},new((P=void 0)||(P=Promise))((function(t,n){function e(t){try{i(S.next(t))}catch(t){n(t)}}function o(t){try{i(S.throw(t))}catch(t){n(t)}}function i(n){var i;n.done?t(n.value):(i=n.value,i instanceof P?i:new P((function(t){t(i)}))).then(e,o)}i((S=S.apply(C,z||[])).next())})));const B=new class{constructor(t=m){this.scene=new o.xsS,this.points=new o.woe,this.phase=0,this.cyclesLeft=0,this.onOptionChanges=new Map([["pointSize",()=>this.setSizes(this.points.geometry)],["pointColor",()=>this.setColors(this.points.geometry)],["randomColor",()=>this.setColors(this.points.geometry)],["pointsNumber",()=>{this.setPositions(this.points.geometry),this.setSizes(this.points.geometry),this.setColors(this.points.geometry)}]]),this.initialOptions=Object.create(t),this.options=this.initOptionsProxy(t),this.buildPoints(),this.scene.add(this.points)}resetOptions(){console.log(this.options.pointSize,this.initialOptions.pointSize),Object.assign(this.options,this.initialOptions)}run(t=1){return u(this,void 0,void 0,(function*(){return new Promise((n=>{this.cyclesLeft+=t;const e=()=>{if(this.phase>=2*Math.PI&&(this.phase=0,this.cyclesLeft--),!(this.cyclesLeft>0))return n();this.phase+=.02*this.options.speed,requestAnimationFrame(e)};this.cyclesLeft===t&&e()}))}))}stop(){this.cyclesLeft=0}initOptionsProxy(t){return t.pointColor=new Proxy(t.pointColor,{get:(t,n,e)=>Reflect.get(t,n,e),set:(n,e,o)=>{const i=Reflect.set(n,e,o);return t.randomColor||this.onOptionChanges.get("pointColor")(),i}}),new Proxy(t,{get:(t,n,e)=>Reflect.get(t,n,e),set:(t,n,e)=>{const o=Reflect.set(t,n,e);return this.onOptionChanges.has(n)&&this.onOptionChanges.get(n)(),o}})}buildPoints(){return u(this,void 0,void 0,(function*(){this.points.geometry=yield this.initGeometry(yield this.options.geometry),this.points.material=this.initMaterial(),this.points.onBeforeRender=()=>{this.points.material.uniforms.uTime.value=.001*performance.now(),this.points.material.uniforms.uWobbliness.value=this.options.wobbliness,this.points.material.uniforms.uIntensity.value=this.options.intensity,this.points.material.uniforms.uPhase.value=this.phase}}))}initGeometry(t){return u(this,void 0,void 0,(function*(){const n=new o.u9r;return yield this.setPositions(n,t),this.setColors(n),this.setSizes(n),n}))}setPositions(t,n){const e=[];n?this.lastShape=n:null!==n&&(n=this.lastShape);const i=n?(()=>{const t=new o.Kj0(n),e=new c.a(t).build(),i=new o.Pa4;return()=>(e.sample(i),[i.x,i.y,i.z])})():()=>[.5-Math.random(),.5-Math.random(),.5-Math.random()];for(let t=0;t<this.options.pointsNumber;t++){const n=3*t,o=i();e[n]=o[0],e[n+1]=o[1],e[n+2]=o[2]}t.setAttribute("position",new o.a$l(e,3))}setSizes(t){const n=[];for(let t=0;t<3*this.options.pointsNumber;t++)n.push(Math.random()*this.options.pointSize);t.setAttribute("size",new o.a$l(n,1))}setColors(t){const n=[],e=[this.options.pointColor.r/255,this.options.pointColor.g/255,this.options.pointColor.b/255];for(let t=0;t<this.options.pointsNumber;t++)this.options.randomColor?n.push(Math.random(),Math.random(),Math.random()):n.push(...e);t.setAttribute("color",new o.a$l(n,3))}initMaterial(){return new o.jyz({uniforms:{uTime:{value:0},uPhase:{value:0},uWobbliness:{value:this.options.wobbliness},uIntensity:{value:this.options.intensity}},glslVersion:o.LSk,vertexShader:l(),fragmentShader:h(),depthTest:!0,transparent:!0,vertexColors:!0})}}(w);B.run(1/0),y.scene=B.scene,y.camera.position.set(0,0,1);const O=(new(v())).addFolder({title:"Настройки",expanded:!1});O.addInput(B.options,"pointsNumber",{label:"Количество",min:100,max:1e5}),O.addInput(B.options,"pointSize",{label:"Размер",min:1,max:200}),O.addInput(B.options,"wobbliness",{label:"Wobbliness",min:0,max:3}),O.addInput(B.options,"intensity",{label:"Интенсивность",min:0,max:3});const M=O.addFolder({title:"Цвет",expanded:!1});M.addInput(B.options,"randomColor",{label:"Случайный"}),M.addInput(B.options,"pointColor",{label:"Цвет"});const R=O.addFolder({title:"Камера",expanded:!1}),I=R.addInput(y.camera,"position",{label:"Координаты"}),E=R.addInput(y.camera,"rotation",{label:"Углы Эйлера"}),W=y.camera.clone();R.addButton({title:"Сбросить камеру"}).on("click",(()=>function(t,n,e,o){return new(e||(e=Promise))((function(i,s){function r(t){try{l(o.next(t))}catch(t){s(t)}}function a(t){try{l(o.throw(t))}catch(t){s(t)}}function l(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(r,a)}l((o=o.apply(t,n||[])).next())}))}(void 0,void 0,void 0,(function*(){y.camera.position.copy(W.position),y.camera.rotation.copy(W.rotation)})))),O.addInput(B.options,"speed",{label:"Скорость",min:0,max:5});const L=O.addInput(B,"phase",{label:"Фаза",min:0,max:2*Math.PI});O.addButton({title:"Стоп/Старт"}).on("click",(()=>{0===B.cyclesLeft?B.run(1/0):B.stop()}));const D=()=>{requestAnimationFrame((()=>{I.refresh(),E.refresh(),L.refresh(),D()}))};D()},748:t=>{t.exports="uniform float uPhase;\r\nuniform float uIntensity;\r\nin vec3 vColor;\r\nin vec3 vPosition;\r\nin float vWave;\r\nin float vSize;\r\nout vec4 fragColor;\r\n\r\nvoid main() {\r\n    if (length(gl_PointCoord.xy - .5) > .4 || vSize < .1) discard;\r\n    fragColor = vec4(vColor, 1.);\r\n}\r\n"},17:t=>{t.exports="attribute float size;\r\nuniform float uTime;\r\nuniform float uPhase;\r\nuniform float uWobbliness;\r\nuniform float uIntensity;\r\nout vec3 vColor;\r\nout vec3 vPosition;\r\nout float vWave;\r\nout float vSize;\r\n\r\nvoid main() {\r\n    vColor = color;\r\n    vPosition = position;\r\n    vSize = size;\r\n\r\n    vWave = pow(.5 + .5 * sin(vPosition.x * 2. - uPhase - 1.), 12.);\r\n\r\n    if (uIntensity > 0.) {\r\n        vSize *= uIntensity * max(vWave, .0001);\r\n    }\r\n\r\n    vec3 shift = .02 * vec3(cos(vPosition.yzx * uWobbliness * 15. + vWave * uWobbliness));\r\n\r\n    vec4 mvPosition = modelViewMatrix * vec4(vPosition + shift, 1.0);\r\n    vSize /= -mvPosition.z;\r\n    gl_PointSize = vSize;\r\n    gl_Position = projectionMatrix * mvPosition;\r\n}\r\n"}},e={};function o(t){var i=e[t];if(void 0!==i)return i.exports;var s=e[t]={exports:{}};return n[t].call(s.exports,s,s.exports,o),s.exports}o.m=n,t=[],o.O=(n,e,i,s)=>{if(!e){var r=1/0;for(d=0;d<t.length;d++){for(var[e,i,s]=t[d],a=!0,l=0;l<e.length;l++)(!1&s||r>=s)&&Object.keys(o.O).every((t=>o.O[t](e[l])))?e.splice(l--,1):(a=!1,s<r&&(r=s));a&&(t.splice(d--,1),n=i())}return n}s=s||0;for(var d=t.length;d>0&&t[d-1][2]>s;d--)t[d]=t[d-1];t[d]=[e,i,s]},o.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return o.d(n,{a:n}),n},o.d=(t,n)=>{for(var e in n)o.o(n,e)&&!o.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},o.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),(()=>{var t={179:0};o.O.j=n=>0===t[n];var n=(n,e)=>{var i,s,[r,a,l]=e,d=0;for(i in a)o.o(a,i)&&(o.m[i]=a[i]);for(l&&l(o),n&&n(e);d<r.length;d++)s=r[d],o.o(t,s)&&t[s]&&t[s][0](),t[r[d]]=0;o.O()},e=self.webpackChunkpoints_widget=self.webpackChunkpoints_widget||[];e.forEach(n.bind(null,0)),e.push=n.bind(null,e.push.bind(e))})();var i=o.O(void 0,[669],(()=>o(419)));i=o.O(i)})();